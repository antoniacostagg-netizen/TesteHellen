<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moda Feminina</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ===============================
           CONFIGURAÇÕES DE CORES - ADMINISTRADOR PODE ALTERAR
           Altere as cores abaixo para personalizar o tema do site
        =============================== */
        :root {
            --primary-color: #d95e9d;    /* Cor principal (botões, destaques) */
            --secondary-color: #4ecdc4;  /* Cor secundária */
            --accent-color: #ffbe0b;     /* Cor de destaque */
            --text-color: #333333;       /* Cor do texto principal */
            --light-bg: #f8f9fa;         /* Cor de fundo clara */
            --dark-bg: #343a40;          /* Cor de fundo escura */
            --white: #ffffff;            /* Branco */
            --gray: #6c757d;             /* Cinza */
            --success: #28a745;          /* Cor para sucesso */
        }

        /* ===============================
           ESTILOS GERAIS
        =============================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--light-bg);
            color: var(--text-color);
            padding-top: 70px; /* Espaço para o cabeçalho fixo */
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* ===============================
           CABEÇALHO
        =============================== */
        header {
            background-color: var(--white);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            padding: 10px 0;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Logo - Administrador pode substituir a imagem em public/assets/logo.png */
        .logo img {
            height: 40px;
        }

        .header-icons {
            display: flex;
            gap: 15px;
        }

        .header-icons a {
            color: var(--text-color);
            font-size: 1.2rem;
            text-decoration: none;
        }

        /* Menu lateral */
        .side-menu {
            position: fixed;
            top: 0;
            right: -300px;
            width: 300px;
            height: 100vh;
            background-color: var(--white);
            box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
            z-index: 1001;
            transition: right 0.3s ease;
            padding: 60px 20px 20px;
        }

        .side-menu.open {
            right: 0;
        }

        .side-menu ul {
            list-style: none;
        }

        .side-menu li {
            margin-bottom: 15px;
        }

        .side-menu a {
            color: var(--text-color);
            text-decoration: none;
            font-size: 1.1rem;
            display: block;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }

        .close-menu {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
        }

        .overlay.active {
            display: block;
        }

        /* Mensagem informativa no cabeçalho */
        .info-banner {
            background-color: var(--primary-color);
            color: white;
            text-align: center;
            padding: 8px 0;
            font-size: 0.9rem;
        }

        /* ===============================
           CATÁLOGO DE PRODUTOS
        =============================== */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            padding: 20px 0;
        }

        .product-card {
            background-color: var(--white);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .product-card:hover {
            transform: translateY(-5px);
        }

        .product-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
        }

        .product-info {
            padding: 15px;
        }

        .product-name {
            font-size: 1rem;
            margin-bottom: 8px;
        }

        .product-price {
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .buy-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        .buy-btn:hover {
            background-color: #e55c5c;
        }

        /* ===============================
           MODAL DE DETALHES DO PRODUTO
        =============================== */
        .product-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1002;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }

        .product-modal.open {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background-color: var(--white);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            border-radius: 8px;
            padding: 20px;
            position: relative;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .product-gallery {
            position: relative;
            margin-bottom: 20px;
        }

        .main-image {
            width: 100%;
            height: 350px;
            object-fit: contain;
            margin-bottom: 10px;
        }

        .thumbnails {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .thumbnail {
            width: 70px;
            height: 70px;
            object-fit: cover;
            cursor: pointer;
            border: 2px solid transparent;
            border-radius: 4px;
        }

        .thumbnail.active {
            border-color: var(--primary-color);
        }

        .color-options {
            margin: 20px 0;
        }

        .color-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .color-name {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .color-dot {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: inline-block;
        }

        .quantity-input {
            width: 60px;
            padding: 5px;
            text-align: center;
        }

        .add-to-cart-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            font-weight: bold;
            font-size: 1.1rem;
            margin-top: 20px;
            transition: background-color 0.3s;
        }

        .add-to-cart-btn:hover {
            background-color: #e55c5c;
        }

        /* ===============================
           CARRINHO E FINALIZAÇÃO
        =============================== */
        .cart-btn {
            position: relative;
        }

        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 0.7rem;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .checkout-float-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 15px 25px;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            z-index: 999;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkout-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1002;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }

        .checkout-modal.open {
            opacity: 1;
            visibility: visible;
        }

        .checkout-content {
            background-color: var(--white);
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            border-radius: 8px;
            padding: 20px;
            position: relative;
        }

        .cart-items {
            margin: 20px 0;
            max-height: 300px;
            overflow-y: auto;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .total-price {
            font-weight: bold;
            font-size: 1.2rem;
            text-align: right;
            margin: 20px 0;
        }

        .submit-order {
            background-color: var(--success);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            font-weight: bold;
            font-size: 1.1rem;
        }

        /* ===============================
           FILTROS E CATEGORIAS
        =============================== */
        .filters {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .filter-btn {
            background-color: var(--white);
            border: 1px solid #ddd;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .filter-btn.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* ===============================
           RESPONSIVIDADE
        =============================== */
        @media (max-width: 768px) {
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 15px;
            }
            
            .product-image {
                height: 180px;
            }
            
            .main-image {
                height: 250px;
            }
            
            .thumbnails {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <!-- Mensagem informativa -->
    <div class="info-banner">
        Escolha seu produto e seu pedido será enviado via WhatsApp.
    </div>

    <!-- Cabeçalho -->
    <header>
        <div class="container header-content">
            <!-- Logo - Administrador pode substituir a imagem em public/assets/logo.png -->
            <div class="logo">
                <img src="https://i.postimg.cc/wvJZmKZm/logo-hellen.png" alt="Logo" id="logo-image">
            </div>
            
            <div class="header-icons">
                <a href="#" class="home-btn"><i class="fas fa-home"></i></a>
                <a href="#" class="menu-btn"><i class="fas fa-bars"></i></a>
                <a href="#" class="cart-btn">
                    <i class="fas fa-shopping-cart"></i>
                    <span class="cart-count">0</span>
                </a>
            </div>
        </div>
    </header>

    <!-- Menu lateral -->
    <div class="side-menu" id="side-menu">
        <button class="close-menu"><i class="fas fa-times"></i></button>
        <ul>
            <!-- Categorias - Administrador pode editar essa lista -->
            <li><a href="#" data-category="all">Todos os produtos</a></li>
            <li><a href="#" data-category="Conjuntos">Conjuntos</a></li>
            <li><a href="#" data-category="Macaquinhos">Macaquinhos</a></li>
            <li><a href="#" data-category="Tops">Tops</a></li>
            <li><a href="#" data-category="Shorts">Shorts</a></li>
        </ul>
    </div>
    <div class="overlay" id="overlay"></div>

    <!-- Conteúdo principal -->
    <main class="container">
        <!-- Filtros de categoria -->
        <div class="filters" id="category-filters">
            <!-- Filtros serão gerados dinamicamente pelo JavaScript -->
        </div>

        <!-- Grade de produtos -->
        <div class="products-grid" id="products-grid">
            <!-- Produtos serão carregados dinamicamente pelo JavaScript -->
        </div>
    </main>

    <!-- Modal de detalhes do produto -->
    <div class="product-modal" id="product-modal">
        <div class="modal-content">
            <button class="close-modal"><i class="fas fa-times"></i></button>
            <div class="product-gallery">
                <img src="" alt="Produto" class="main-image" id="modal-main-image">
                <div class="thumbnails" id="modal-thumbnails">
                    <!-- Miniaturas serão adicionadas dinamicamente -->
                </div>
            </div>
            <h2 id="modal-product-name"></h2>
            <p class="product-price" id="modal-product-price"></p>
            <p id="modal-product-description"></p>
            
            <div class="color-options" id="modal-color-options">
                <!-- Opções de cor serão adicionadas dinamicamente -->
            </div>
            
            <button class="add-to-cart-btn" id="add-to-cart-modal">Adicionar ao Carrinho</button>
        </div>
    </div>

    <!-- Botão flutuante de finalizar compra -->
    <button class="checkout-float-btn" id="checkout-float-btn">
        <i class="fas fa-shopping-bag"></i> Finalizar Compra
    </button>

    <!-- Modal de finalização de compra -->
    <div class="checkout-modal" id="checkout-modal">
        <div class="checkout-content">
            <button class="close-modal"><i class="fas fa-times"></i></button>
            <h2>Finalizar Pedido</h2>
            
            <div class="cart-items" id="checkout-items">
                <!-- Itens do carrinho serão adicionados dinamicamente -->
            </div>
            
            <div class="total-price" id="checkout-total">Total: R$ 0,00</div>
            
            <form id="checkout-form">
                <div class="form-group">
                    <label for="customer-name">Nome</label>
                    <input type="text" id="customer-name" required>
                </div>
                
                <div class="form-group">
                    <label for="customer-cep">CEP</label>
                    <input type="text" id="customer-cep" placeholder="O frete será calculado quando o pedido for enviado via WhatsApp.">
                </div>
                
                <div class="form-group">
                    <label for="customer-address">Endereço</label>
                    <input type="text" id="customer-address" required>
                </div>
                
                <div class="form-group">
                    <label for="customer-phone">Telefone</label>
                    <input type="tel" id="customer-phone" required>
                </div>
                
                <div class="form-group">
                    <label for="payment-method">Forma de pagamento</label>
                    <select id="payment-method" required>
                        <option value="">Selecione...</option>
                        <option value="Pix">Pix</option>
                        <option value="Cartão de Crédito">Cartão de Crédito</option>
                        <option value="Cartão de Débito">Cartão de Débito</option>
                        <option value="Dinheiro">Dinheiro</option>
                    </select>
                </div>
                
                <button type="submit" class="submit-order">Enviar Pedido via WhatsApp</button>
            </form>
        </div>
    </div>

    <script>
       // ===============================
// CONFIGURAÇÕES DO ADMINISTRADOR
// ===============================

// Caminho para o arquivo JSON de produtos
// O administrador deve colocar o arquivo products.json em /data/products.json
const PRODUCTS_JSON_PATH = 'data/products.json';

// Caminho para a logo - substitua pelo caminho correto da imagem
const LOGO_PATH = 'https://i.postimg.cc/wvJZmKZm/logo-hellen.png'; // Substitua pelo seu link

// Número do WhatsApp para envio dos pedidos
// Substitua pelo número do fornecedor no formato 5511999999999 (código do país + DDD + número)
const WHATSAPP_NUMBER = '5585989408154';

// Template da mensagem do WhatsApp
// Use {variaveis} para incluir dados dinâmicos no pedido
const WHATSAPP_TEMPLATE = `
Olá, gostaria de fazer um pedido:

*Itens do pedido:*
{itens}

*Total: R$ {total}*

*Dados do cliente:*
Nome: {nome}
Endereço: {endereço}
CEP: {cep}
Telefone: {telefone}
Forma de pagamento: {pagamento}

*Observações:*
{observacoes}
`;

// ===============================
// VARIÁVEIS GLOBAIS
// ===============================
let products = [];
let cart = [];
let currentCategory = 'all';

// ===============================
// ELEMENTOS DO DOM
// ===============================
const domElements = {
    productsGrid: document.getElementById('products-grid'),
    categoryFilters: document.getElementById('category-filters'),
    sideMenu: document.getElementById('side-menu'),
    overlay: document.getElementById('overlay'),
    menuBtn: document.querySelector('.menu-btn'),
    closeMenuBtn: document.querySelector('.close-menu'),
    productModal: document.getElementById('product-modal'),
    checkoutModal: document.getElementById('checkout-modal'),
    checkoutFloatBtn: document.getElementById('checkout-float-btn'),
    checkoutForm: document.getElementById('checkout-form'),
    cartCount: document.querySelector('.cart-count'),
    logoImage: document.getElementById('logo-image')
};

// ===============================
// FUNÇÕES DE INICIALIZAÇÃO
// ===============================

// Carrega os produtos do arquivo JSON
async function loadProducts() {
    try {
        console.log('Carregando produtos de:', PRODUCTS_JSON_PATH);
        const response = await fetch(PRODUCTS_JSON_PATH);
        
        if (!response.ok) {
            throw new Error(`Erro HTTP! status: ${response.status}`);
        }
        
        const data = await response.json();
        console.log('Produtos carregados:', data.length);
        
        products = data;
        renderProducts();
        renderCategoryFilters();
    } catch (error) {
        console.error('Erro ao carregar produtos:', error);
        // Usar produtos de fallback em caso de erro
        useFallbackProducts();
    }
}

// Produtos de fallback (exemplo)
function getFallbackProducts() {
    return [
        {
            id: "p001",
            name: "Conjunto Floral",
            price: 79.90,
            photos: [
                "https://i.postimg.cc/3JyM5JX3/1.png",
                "https://i.postimg.cc/ZqQ7L6Q3/2.png",
                "https://i.postimg.cc/gJJwGZcM/3.png"
            ],
            category: "Conjuntos",
            colors: [
                { name: "Vermelho", stock: 5 },
                { name: "Preto", stock: 3 },
                { name: "Branco", stock: 8 }
            ],
            description: "Conjunto leve de verão"
        },
        {
            id: "p002",
            name: "Macaquinho Liso",
            price: 59.90,
            photos: [
                "https://i.postimg.cc/V6Y5sH1B/4.png",
                "https://i.postimg.cc/5NNzxypQ/5.png",
                "https://i.postimg.cc/FRyPQzpn/6.png"
            ],
            category: "Macaquinhos",
            colors: [
                { name: "Azul", stock: 4 },
                { name: "Rosa", stock: 6 },
                { name: "Verde", stock: 2 }
            ],
            description: "Macaquinho confortável"
        },

         {
            id: "p001",
            name: "Macaquinho Estação",
            price: 79.90,
            photos: [
                "https://i.postimg.cc/3rt8G5Pz/7.png",
                "https://i.postimg.cc/ydgN6fNk/8.png",
                "https://i.postimg.cc/j5shG7qg/9.png"
            ],
            category: "Macaquinhos",
            colors: [
                { name: "Vermelho", stock: 5 },
                { name: "Preto", stock: 3 },
                { name: "Branco", stock: 8 }
            ],
            description: "Macaquinho Estação"
        },

         {
            id: "p001",
            name: "Conjunto Floral",
            price: 79.90,
            photos: [
                "https://i.postimg.cc/3JyM5JX3/1.png",
                "https://i.postimg.cc/ZqQ7L6Q3/2.png",
                "https://i.postimg.cc/gJJwGZcM/3.png"
            ],
            category: "Conjuntos",
            colors: [
                { name: "Vermelho", stock: 5 },
                { name: "Preto", stock: 3 },
                { name: "Branco", stock: 8 }
            ],
            description: "Conjunto leve de verão"
        },
         {
            id: "p002",
            name: "Macaquinho Liso",
            price: 59.90,
            photos: [
                "https://i.postimg.cc/V6Y5sH1B/4.png",
                "https://i.postimg.cc/5NNzxypQ/5.png",
                "https://i.postimg.cc/FRyPQzpn/6.png"
            ],
            category: "Macaquinhos",
            colors: [
                { name: "Azul", stock: 4 },
                { name: "Rosa", stock: 6 },
                { name: "Verde", stock: 2 }
            ],
            description: "Macaquinho confortável"
        },
          
        {
            id: "p001",
            name: "Macaquinho Estação",
            price: 79.90,
            photos: [
                "https://i.postimg.cc/3rt8G5Pz/7.png",
                "https://i.postimg.cc/ydgN6fNk/8.png",
                "https://i.postimg.cc/j5shG7qg/9.png"
            ],
            category: "Macaquinhos",
            colors: [
                { name: "Vermelho", stock: 5 },
                { name: "Preto", stock: 3 },
                { name: "Branco", stock: 8 }
            ],
            description: "Macaquinho Estação"
        },

    ];
}

// Usar produtos de fallback e exibir mensagem
function useFallbackProducts() {
    products = getFallbackProducts();
    renderProducts();
    renderCategoryFilters();
    
    // Adicionar mensagem informativa
    const message = document.createElement('div');
    message.style.cssText = `
        grid-column: 1 / -1;
        text-align: center;
        padding: 20px;
        background-color: #fff3cd;
        border: 1px solid #ffeaa7;
        border-radius: 5px;
        margin: 10px 0;
        color: #856404;
    `;
    message.innerHTML = `
        <p><strong>Aviso:</strong> Carregando produtos de exemplo.</p>
        <p>Verifique se o arquivo <code>data/products.json</code> existe para carregar seus produtos.</p>
    `;
    
    // Inserir a mensagem antes da grade de produtos
    domElements.productsGrid.parentNode.insertBefore(message, domElements.productsGrid);
}

// Define a logo do site
function setupLogo() {
    domElements.logoImage.src = LOGO_PATH;
}

// ===============================
// FUNÇÕES DE RENDERIZAÇÃO
// ===============================

// Renderiza os produtos na grade
function renderProducts() {
    domElements.productsGrid.innerHTML = '';
    
    const filteredProducts = currentCategory === 'all' 
        ? products 
        : products.filter(product => product.category === currentCategory);
    
    filteredProducts.forEach(product => {
        const productCard = document.createElement('div');
        productCard.className = 'product-card';
        productCard.innerHTML = `
            <img src="${product.photos[0]}" alt="${product.name}" class="product-image">
            <div class="product-info">
                <h3 class="product-name">${product.name}</h3>
                <p class="product-price">R$ ${product.price.toFixed(2)}</p>
                <button class="buy-btn" data-id="${product.id}">Comprar</button>
            </div>
        `;
        domElements.productsGrid.appendChild(productCard);
    });
    
    // Adiciona event listeners aos botões de compra
    document.querySelectorAll('.buy-btn').forEach(button => {
        button.addEventListener('click', (e) => {
            const productId = e.target.getAttribute('data-id');
            openProductModal(productId);
        });
    });
}

// Renderiza os filtros de categoria
function renderCategoryFilters() {
    // Extrai todas as categorias únicas dos produtos
    const categories = ['all', ...new Set(products.map(product => product.category))];
    
    domElements.categoryFilters.innerHTML = '';
    
    categories.forEach(category => {
        const filterBtn = document.createElement('button');
        filterBtn.className = `filter-btn ${category === currentCategory ? 'active' : ''}`;
        filterBtn.textContent = category === 'all' ? 'Todos os produtos' : category;
        filterBtn.setAttribute('data-category', category);
        domElements.categoryFilters.appendChild(filterBtn);
    });
    
    // Adiciona event listeners aos filtros
    document.querySelectorAll('.filter-btn').forEach(button => {
        button.addEventListener('click', (e) => {
            currentCategory = e.target.getAttribute('data-category');
            renderProducts();
            
            // Atualiza a classe active dos filtros
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            e.target.classList.add('active');
        });
    });
}

// Abre o modal de detalhes do produto
function openProductModal(productId) {
    const product = products.find(p => p.id === productId);
    if (!product) return;
    
    // Preenche os dados do modal
    document.getElementById('modal-main-image').src = product.photos[0];
    document.getElementById('modal-product-name').textContent = product.name;
    document.getElementById('modal-product-price').textContent = `R$ ${product.price.toFixed(2)}`;
    document.getElementById('modal-product-description').textContent = product.description;
    
    // Renderiza as miniaturas
    const thumbnailsContainer = document.getElementById('modal-thumbnails');
    thumbnailsContainer.innerHTML = '';
    
    product.photos.forEach((photo, index) => {
        const thumbnail = document.createElement('img');
        thumbnail.src = photo;
        thumbnail.alt = `Thumbnail ${index + 1}`;
        thumbnail.className = `thumbnail ${index === 0 ? 'active' : ''}`;
        thumbnail.addEventListener('click', () => {
            document.getElementById('modal-main-image').src = photo;
            document.querySelectorAll('.thumbnail').forEach(thumb => thumb.classList.remove('active'));
            thumbnail.classList.add('active');
        });
        thumbnailsContainer.appendChild(thumbnail);
    });
    
    // Renderiza as opções de cor
    const colorOptionsContainer = document.getElementById('modal-color-options');
    colorOptionsContainer.innerHTML = '';
    
    product.colors.forEach(color => {
        const colorOption = document.createElement('div');
        colorOption.className = 'color-option';
        colorOption.innerHTML = `
            <div class="color-name">
                <span class="color-dot" style="background-color: ${getColorCode(color.name)}"></span>
                ${color.name} ${color.stock > 0 ? `(Estoque: ${color.stock})` : '(Esgotado)'}
            </div>
            <input type="number" class="quantity-input" min="0" max="${color.stock}" value="0" 
                   ${color.stock === 0 ? 'disabled' : ''} data-color="${color.name}">
        `;
        colorOptionsContainer.appendChild(colorOption);
    });
    
    // Configura o botão de adicionar ao carrinho
    const addToCartBtn = document.getElementById('add-to-cart-modal');
    addToCartBtn.onclick = () => addToCart(product);
    
    // Abre o modal
    domElements.productModal.classList.add('open');
    document.body.style.overflow = 'hidden';
}

// Retorna um código de cor baseado no nome (para demonstração)
function getColorCode(colorName) {
    const colorMap = {
        'Vermelho': '#ff6b6b',
        'Preto': '#333333',
        'Branco': '#f8f9fa',
        'Azul': '#4ecdc4',
        'Rosa': '#ff6b9d',
        'Verde': '#a3d39c',
        'Amarelo': '#ffbe0b',
        'Roxo': '#9b5de5'
    };
    
    return colorMap[colorName] || '#cccccc';
}

// Adiciona produto ao carrinho
function addToCart(product) {
    const colorQuantities = {};
    let totalQuantity = 0;
    
    // Coleta as quantidades selecionadas para cada cor
    document.querySelectorAll('.quantity-input').forEach(input => {
        const quantity = parseInt(input.value);
        const color = input.getAttribute('data-color');
        
        if (quantity > 0) {
            colorQuantities[color] = quantity;
            totalQuantity += quantity;
        }
    });
    
    // Verifica se pelo menos uma quantidade foi selecionada
    if (totalQuantity === 0) {
        alert('Selecione pelo menos um item para adicionar ao carrinho.');
        return;
    }
    
    // Adiciona ao carrinho
    cart.push({
        product: product,
        colorQuantities: colorQuantities,
        totalQuantity: totalQuantity
    });
    
    // Atualiza a contagem do carrinho
    updateCartCount();
    
    // Fecha o modal
    closeModals();
    
    alert('Produto adicionado ao carrinho!');
}

// Atualiza a contagem de itens no carrinho
function updateCartCount() {
    const totalItems = cart.reduce((total, item) => total + item.totalQuantity, 0);
    domElements.cartCount.textContent = totalItems;
}

// Abre o modal de finalização de compra
function openCheckoutModal() {
    if (cart.length === 0) {
        alert('Seu carrinho está vazio!');
        return;
    }
    
    const checkoutItems = document.getElementById('checkout-items');
    checkoutItems.innerHTML = '';
    
    let totalPrice = 0;
    
    // Renderiza os itens do carrinho
    cart.forEach((item, index) => {
        const cartItem = document.createElement('div');
        cartItem.className = 'cart-item';
        
        let colorsText = '';
        for (const [color, quantity] of Object.entries(item.colorQuantities)) {
            colorsText += `${color} (${quantity}), `;
        }
        colorsText = colorsText.slice(0, -2); // Remove a última vírgula e espaço
        
        const itemTotal = item.product.price * item.totalQuantity;
        totalPrice += itemTotal;
        
        cartItem.innerHTML = `
            <div>
                <strong>${item.product.name}</strong>
                <div>${colorsText}</div>
            </div>
            <div>R$ ${itemTotal.toFixed(2)}</div>
        `;
        
        checkoutItems.appendChild(cartItem);
    });
    
    // Atualiza o total
    document.getElementById('checkout-total').textContent = `Total: R$ ${totalPrice.toFixed(2)}`;
    
    // Abre o modal
    domElements.checkoutModal.classList.add('open');
    document.body.style.overflow = 'hidden';
}

// Fecha todos os modais
function closeModals() {
    domElements.productModal.classList.remove('open');
    domElements.checkoutModal.classList.remove('open');
    domElements.sideMenu.classList.remove('open');
    domElements.overlay.classList.remove('active');
    document.body.style.overflow = 'auto';
}

// Prepara e envia o pedido via WhatsApp
function sendWhatsAppOrder(formData) {
    // Prepara o texto dos itens
    let itemsText = '';
    cart.forEach(item => {
        let colorsText = '';
        for (const [color, quantity] of Object.entries(item.colorQuantities)) {
            colorsText += `${color} (${quantity}), `;
        }
        colorsText = colorsText.slice(0, -2);
        
        itemsText += `- ${item.product.name} (${colorsText}): R$ ${(item.product.price * item.totalQuantity).toFixed(2)}\n`;
    });
    
    // Calcula o total
    const total = cart.reduce((sum, item) => sum + (item.product.price * item.totalQuantity), 0);
    
    // Prepara a mensagem com o template
    let message = WHATSAPP_TEMPLATE
        .replace('{itens}', itemsText)
        .replace('{total}', total.toFixed(2))
        .replace('{nome}', formData.name)
        .replace('{endereço}', formData.address)
        .replace('{cep}', formData.cep)
        .replace('{telefone}', formData.phone)
        .replace('{pagamento}', formData.payment)
        .replace('{observacoes}', formData.notes || 'Nenhuma observação');
    
    // Codifica a mensagem para URL
    const encodedMessage = encodeURIComponent(message);
    
    // Cria o link do WhatsApp
    const whatsappURL = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodedMessage}`;
    
    // Abre o WhatsApp
    window.open(whatsappURL, '_blank');
    
    // Limpa o carrinho após o envio
    cart = [];
    updateCartCount();
}

// ===============================
// CONFIGURAÇÃO DE EVENT LISTENERS
// ===============================

// Configura todos os event listeners
function setupEventListeners() {
    // Menu lateral
    domElements.menuBtn.addEventListener('click', () => {
        domElements.sideMenu.classList.add('open');
        domElements.overlay.classList.add('active');
    });
    
    // Botão de fechar menu
    domElements.closeMenuBtn.addEventListener('click', closeModals);
    
    // Overlay para fechar modais
    domElements.overlay.addEventListener('click', closeModals);
    
    // Filtros de categoria no menu lateral
    document.querySelectorAll('.side-menu a').forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            currentCategory = e.target.getAttribute('data-category');
            renderProducts();
            closeModals();
        });
    });
    
    // Botões de fechar modais (corrigido)
    document.addEventListener('click', function(event) {
        if (event.target.closest('.close-modal')) {
            closeModals();
        }
    });
    
    // Botão flutuante de finalizar compra
    domElements.checkoutFloatBtn.addEventListener('click', openCheckoutModal);
    
    // Formulário de finalização
    domElements.checkoutForm.addEventListener('submit', (e) => {
        e.preventDefault();
        
        const formData = {
            name: document.getElementById('customer-name').value,
            cep: document.getElementById('customer-cep').value,
            address: document.getElementById('customer-address').value,
            phone: document.getElementById('customer-phone').value,
            payment: document.getElementById('payment-method').value,
            notes: document.getElementById('customer-notes')?.value || ''
        };
        
        sendWhatsAppOrder(formData);
        closeModals();
    });
}

// ===============================
// INICIALIZAÇÃO
// ===============================
document.addEventListener('DOMContentLoaded', () => {
    setupLogo();
    setupEventListeners();
    loadProducts();
});
    </script>
</body>
</html>
